<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="543" height="387"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="543" height="387"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.13067724312501 63.51880975500001 L 46.13067724312501 387.7097675550001" stroke-miterlimit="10" stroke-width="1.5706926250000002" stroke-dasharray="14.498701153846154,6.282770500000001"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 500.176742649375 63.51880975500001 L 500.176742649375 387.7097675550001" stroke-miterlimit="10" stroke-width="1.5706926250000002" stroke-dasharray="14.498701153846154,6.282770500000001"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 9.424155750000004 12.628368704999998 L 82.83719873625 12.628368704999998 L 82.83719873625 63.51880975500001 L 9.424155750000004 63.51880975500001 L 9.424155750000004 12.628368704999998 Z" stroke-miterlimit="10" stroke-width="3.01572984" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="29.874573727500007" y="44.67049825500001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Alice</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 466.381598109375 12.628368704999998 L 533.971887189375 12.628368704999998 L 533.971887189375 63.51880975500001 L 466.381598109375 63.51880975500001 L 466.381598109375 12.628368704999998 Z" stroke-miterlimit="10" stroke-width="3.01572984" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="486.832016086875" y="44.67049825500001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bob</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 29.167196893125006 101.215432755 L 500.17674264937506 101.215432755 L 517.140222999375 118.17891310499999 L 517.140222999375 144.566549205 L 29.167196893125006 144.566549205 L 29.167196893125006 101.215432755 M 500.17674264937506 101.215432755 L 500.17674264937506 118.17891310499999 L 517.140222999375 118.17891310499999" stroke-miterlimit="10" stroke-width="1.5706926250000002" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="55.55483299312499" y="127.603068855" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Entram em </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="133.074364243125" y="127.603068855" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">acordo</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="183.084129868125" y="127.603068855" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> sobre a </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="241.450829086875" y="127.603068855" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">chave secreta</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="340.693993149375" y="127.603068855" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> (compartilhada) inicial</text></g><g><g><rect fill="white" stroke="none" x="188.20732259625004" y="172.839016455" width="169.8927747" height="24.50280495"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="191.03456932125005" y="189.802496805" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Envia um novo </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="311.10048729000005" y="189.802496805" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">nonce</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 46.13067724312501 197.34182140500002 L 484.658299514375 197.34182140500002" stroke-miterlimit="10" stroke-width="1.5706926250000002" stroke-dasharray=""/><g transform="translate(500.176742649375,197.34182140500002) translate(-500.176742649375,-197.34182140500002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 484.469816399375 189.48835828000003 L 500.176742649375 197.34182140500002 L 484.469816399375 205.19528453 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 29.167196893125006 225.61428865500005 L 500.17674264937506 225.61428865500005 L 517.140222999375 242.57776900500005 L 517.140222999375 268.96540510500006 L 29.167196893125006 268.96540510500006 L 29.167196893125006 225.61428865500005 M 500.17674264937506 225.61428865500005 L 500.17674264937506 242.57776900500005 L 517.140222999375 242.57776900500005" stroke-miterlimit="10" stroke-width="1.5706926250000002" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="133.07070213375" y="252.00192475500006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Atualizam a </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="215.6073232275" y="252.00192475500006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">chave secreta</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="314.85048729" y="252.00192475500006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> compartilhada</text></g><g><g><rect fill="white" stroke="none" x="70.65727376812505" y="297.2378723550001" width="404.99287235625" height="24.50280495"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="73.48452049312505" y="314.2013527050001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Utilizam a </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="143.49672752437505" y="314.2013527050001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">nova chave secreta</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="281.91713768062505" y="314.2013527050001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> (chave simétrica da sessão)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 484.658299514375 321.7406773050001 L 61.649120378125005 321.7406773050001" stroke-miterlimit="10" stroke-width="1.5706926250000002" stroke-dasharray="7.5393246000000005"/><g transform="translate(46.13067724312501,321.7406773050001) translate(-46.13067724312501,-321.7406773050001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 61.83760349312501 313.88721418000006 L 46.13067724312501 321.7406773050001 L 61.83760349312501 329.5941404300001 Z"/><g transform="translate(500.176742649375,321.7406773050001) translate(-500.176742649375,-321.7406773050001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 484.469816399375 313.88721418000006 L 500.176742649375 321.7406773050001 L 484.469816399375 329.5941404300001 Z"/></g></g></g></g><g/><g/></g></svg>